<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCAE - Gerenciamento de Editais</title>
    <link rel="icon" type="image/png" href="/static/img/logo.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/css/dashboard_assistente.css">
    <link rel="stylesheet" href="/static/css/editais_assist.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Menu Toggle Button -->
    <button class="menu-toggle" id="menuToggle">
        <i class="bi bi-list"></i>
    </button>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <button class="close-sidebar" id="closeSidebar">
                <i class="bi bi-x-lg"></i>
            </button>
            <img src="/static/img/logoifes.png" alt="Logo IFES" width="180">
        </div>
        <div class="d-flex flex-column p-3">
            <div class="mb-4 text-center">
                <h6 class="mb-0">Sistema de Controle de</h6>
                <h6>Assistência Estudantil</h6>
            </div>
            <ul class="nav nav-pills flex-column mb-auto">
                <li class="nav-item">
                    <a href="/assistente/inicio" class="nav-link">
                        <i class="bi bi-speedometer2"></i> <span>Início</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/agenda" class="nav-link">
                        <i class="bi bi-calendar-event"></i> <span>Agenda</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/alunos" class="nav-link">
                        <i class="bi bi-people"></i> <span>Alunos</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/analise-inscricoes" class="nav-link">
                        <i class="bi bi-clipboard-check"></i> <span>Análise de Inscrições</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/analise-recursos" class="nav-link">
                        <i class="bi bi-journal-text"></i> <span>Análise de Recursos</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/editais" class="nav-link active bg-success">
                        <i class="bi bi-file-earmark-ruled"></i> <span>Editais</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/entrevistas" class="nav-link">
                        <i class="bi bi-file-earmark-text"></i> <span>Entrevistas Agendadas</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/perfil" class="nav-link">
                        <i class="bi bi-person-circle"></i> <span>Meu Perfil</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/assistente/relatorios" class="nav-link">
                        <i class="bi bi-file-earmark-bar-graph"></i> <span>Relatórios</span>
                    </a>
                </li>
            </ul>
            <hr>
            <div class="text-center">
                <a href="#" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#logoutModal">
                    <i class="bi bi-box-arrow-right"></i> <span>Sair</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Header -->
        <div class="welcome-banner mb-4">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h4 class="mb-3"><i class="bi bi-gear-fill me-2"></i>Gerenciamento de Editais</h4>
                    <p class="mb-0">Publique, edite e controle a visibilidade de editais, anexos e documentos para os alunos.</p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#novoEditalModal">
                        <i class="bi bi-file-earmark-plus me-2"></i>Novo Edital
                    </button>
                </div>
            </div>
        </div>

        <!-- Mensagens -->
        {% if request.query_params.get('sucesso') %}
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle-fill me-2"></i>{{ request.query_params.get('sucesso') }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endif %}

        {% if request.query_params.get('erro') %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ request.query_params.get('erro') }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endif %}

        <!-- Estatísticas Rápidas -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <i class="bi bi-file-earmark-text text-success" style="font-size: 2.5rem;"></i>
                    <h3 class="mt-2 mb-0">{{ editais|length }}</h3>
                    <p class="text-muted mb-0">Editais Publicados</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <i class="bi bi-eye text-primary" style="font-size: 2.5rem;"></i>
                    <h3 class="mt-2 mb-0">{{ editais_ativos }}</h3>
                    <p class="text-muted mb-0">Editais Visíveis</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <i class="bi bi-pencil-square text-warning" style="font-size: 2.5rem;"></i>
                    <h3 class="mt-2 mb-0">{{ inscricoes_abertas }}</h3>
                    <p class="text-muted mb-0">Inscrições Abertas</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card text-center">
                    <i class="bi bi-files text-info" style="font-size: 2.5rem;"></i>
                    <h3 class="mt-2 mb-0">5</h3>
                    <p class="text-muted mb-0">Anexos Disponíveis</p>
                </div>
            </div>
        </div>

        <!-- Tabs de Navegação -->
        <ul class="nav nav-tabs mb-4" id="editalTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="editais-tab" data-bs-toggle="tab" data-bs-target="#editais" type="button">
                    <i class="bi bi-file-earmark-ruled me-2"></i>Editais Publicados
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="anexos-tab" data-bs-toggle="tab" data-bs-target="#anexos" type="button">
                    <i class="bi bi-files me-2"></i>Anexos e Documentos
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="visibilidade-tab" data-bs-toggle="tab" data-bs-target="#visibilidade" type="button">
                    <i class="bi bi-eye me-2"></i>Controle de Visibilidade
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="editalTabsContent">
            <!-- Tab: Editais Publicados -->
            <div class="tab-pane fade show active" id="editais" role="tabpanel">
                {% if editais %}
                    {% for edital in editais %}
                    <div class="card edital-card mb-3">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-md-7">
                                    <h5 class="mb-2">
                                        <i class="bi bi-file-earmark-pdf text-danger me-2"></i>
                                        {{ edital.titulo }}
                                    </h5>
                                    <p class="text-muted mb-2">{{ edital.descricao }}</p>
                                    
                                    <div class="d-flex flex-wrap gap-2 mb-2">
                                        {% if edital.status == 'ativo' %}
                                        <span class="status-badge status-ativo">
                                            <i class="bi bi-eye me-1"></i>Visível para Alunos
                                        </span>
                                        {% else %}
                                        <span class="status-badge status-inativo">
                                            <i class="bi bi-eye-slash me-1"></i>Oculto dos Alunos
                                        </span>
                                        {% endif %}
                                        
                                        {% if edital.inscricoes_abertas %}
                                        <span class="badge bg-success">
                                            <i class="bi bi-door-open me-1"></i>Inscrições Abertas
                                        </span>
                                        {% elif edital.inscricoes_encerradas %}
                                        <span class="badge bg-secondary">
                                            <i class="bi bi-door-closed me-1"></i>Inscrições Encerradas
                                        </span>
                                        {% elif edital.inscricoes_futuras %}
                                        <span class="badge bg-info">
                                            <i class="bi bi-clock me-1"></i>Em Breve
                                        </span>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="small text-muted">
                                        <div><i class="bi bi-calendar-event me-1"></i>Publicado em: 
                                            {% set data_pub = edital.data_publicacao.split('-') %}
                                            {{ data_pub[2] }}/{{ data_pub[1] }}/{{ data_pub[0] }}
                                        </div>
                                        {% if edital.data_inicio_inscricao and edital.data_fim_inscricao %}
                                        <div><i class="bi bi-pencil-square me-1"></i>Inscrições: 
                                            {% set data_inicio = edital.data_inicio_inscricao.split('-') %}
                                            {% set data_fim = edital.data_fim_inscricao.split('-') %}
                                            {{ data_inicio[2] }}/{{ data_inicio[1] }}/{{ data_inicio[0] }} a {{ data_fim[2] }}/{{ data_fim[1] }}/{{ data_fim[0] }}
                                        </div>
                                        {% endif %}
                                        {% if edital.data_inicio_vigencia and edital.data_fim_vigencia %}
                                        <div><i class="bi bi-calendar-range me-1"></i>Vigência: 
                                            {% set data_inicio_vig = edital.data_inicio_vigencia.split('-') %}
                                            {% set data_fim_vig = edital.data_fim_vigencia.split('-') %}
                                            {{ data_inicio_vig[2] }}/{{ data_inicio_vig[1] }}/{{ data_inicio_vig[0] }} a {{ data_fim_vig[2] }}/{{ data_fim_vig[1] }}/{{ data_fim_vig[0] }}
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                                
                                <div class="col-md-5 text-end">
                                    <div class="btn-group mb-2" role="group">
                                        <a href="/static/{{ edital.arquivo }}" class="btn btn-outline-primary action-btn" target="_blank" title="Visualizar PDF">
                                            <i class="bi bi-eye"></i>
                                        </a>
                                        <a href="/static/{{ edital.arquivo }}" download class="btn btn-outline-info action-btn" title="Baixar PDF">
                                            <i class="bi bi-download"></i>
                                        </a>
                                        <button class="btn btn-outline-warning action-btn" title="Editar" 
                                                onclick="abrirModalEditar({{ edital.id_edital }}, '{{ edital.titulo|e }}', '{{ edital.descricao|e }}', '{{ edital.data_inicio_inscricao }}', '{{ edital.data_fim_inscricao }}', '{{ edital.data_inicio_vigencia }}', '{{ edital.data_fim_vigencia }}', '{{ edital.status }}')">
                                            <i class="bi bi-pencil"></i>
                                        </button>
                                        <button class="btn btn-outline-danger action-btn" title="Excluir" 
                                                onclick="abrirModalExcluir({{ edital.id_edital }}, '{{ edital.titulo|e }}')">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="mt-2">
                                        {% if edital.status == 'ativo' %}
                                        <button class="btn btn-sm btn-warning w-100" onclick="alternarVisibilidade({{ edital.id_edital }}, 'inativo')" title="Ocultar dos alunos">
                                            <i class="bi bi-eye-slash me-1"></i>Tornar Invisível
                                        </button>
                                        {% else %}
                                        <button class="btn btn-sm btn-success w-100" onclick="alternarVisibilidade({{ edital.id_edital }}, 'ativo')" title="Mostrar para alunos">
                                            <i class="bi bi-eye me-1"></i>Tornar Visível
                                        </button>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        Nenhum edital publicado ainda. Clique em "Novo Edital" para começar.
                    </div>
                {% endif %}
            </div>

            <!-- Tab: Anexos e Documentos -->
            <div class="tab-pane fade" id="anexos" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-files me-2"></i>Anexos para Inscrição</h5>
                    </div>
                    <div class="card-body">
                        <p class="text-muted mb-4">
                            <i class="bi bi-info-circle me-2"></i>
                            Estes documentos são exibidos para todos os alunos na página de editais. Eles podem visualizar e baixar cada anexo.
                        </p>
                        
                        {% set anexos = [
                            {'nome': 'Anexo I - Formulário Socioeconômico', 'arquivo': '/static/docs/2025/ANEXO_I_2025.pdf'},
                            {'nome': 'Anexo III - Termo de Responsabilidade', 'arquivo': '/static/docs/2025/ANEXO_III_2025.pdf'},
                            {'nome': 'Anexo IV - Declaração de Residência Alugada', 'arquivo': '/static/docs/2025/ANEXO_IV_2025.pdf'},
                            {'nome': 'Anexo V - Declaração de Composição Familiar', 'arquivo': '/static/docs/2025/ANEXO_V_2025.pdf'},
                            {'nome': 'Anexo VI - Termo de Compromisso', 'arquivo': '/static/docs/2025/ANEXO_VI_2025.pdf'}
                        ] %}
                        
                        <div class="list-group">
                            {% for anexo in anexos %}
                            <div class="list-group-item anexo-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">
                                            <i class="bi bi-file-earmark-text text-primary me-2"></i>
                                            {{ anexo.nome }}
                                        </h6>
                                        <small class="text-muted">Disponível para visualização e download</small>
                                    </div>
                                    <div class="btn-group" role="group">
                                        <a href="{{ anexo.arquivo }}" class="btn btn-sm btn-outline-primary" target="_blank" title="Visualizar">
                                            <i class="bi bi-eye me-1"></i>Visualizar
                                        </a>
                                        <a href="{{ anexo.arquivo }}" download class="btn btn-sm btn-outline-info" title="Baixar">
                                            <i class="bi bi-download me-1"></i>Baixar
                                        </a>
                                        <button class="btn btn-sm btn-outline-warning" title="Substituir Arquivo">
                                            <i class="bi bi-arrow-repeat me-1"></i>Substituir
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <div class="alert alert-warning mt-4">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            <strong>Atenção:</strong> Ao substituir um arquivo, certifique-se de que o novo documento mantém o mesmo nome e formato para não quebrar links existentes.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Controle de Visibilidade -->
            <div class="tab-pane fade" id="visibilidade" role="tabpanel">
                <div class="control-section">
                    <h5 class="mb-4"><i class="bi bi-sliders me-2"></i>Controle de Visibilidade Geral</h5>
                    
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="visibility-toggle">
                                <h6 class="mb-3"><i class="bi bi-file-earmark-ruled me-2 text-success"></i>Editais</h6>
                                <p class="text-muted small mb-3">Controle quais editais são visíveis para os alunos na página /aluno/editais</p>
                                
                                <div class="list-group">
                                    {% if editais %}
                                        {% for edital in editais %}
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>
                                                <strong>{{ edital.titulo[:50] }}...</strong>
                                                <br>
                                                <small class="text-muted">Publicado em {{ edital.data_publicacao }}</small>
                                            </div>
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" 
                                                       id="visibilidade{{ edital.id_edital }}" 
                                                       {% if edital.status == 'ativo' %}checked{% endif %}
                                                       onchange="alternarVisibilidade({{ edital.id_edital }}, this.checked ? 'ativo' : 'inativo')">
                                                <label class="form-check-label" for="visibilidade{{ edital.id_edital }}">
                                                    {% if edital.status == 'ativo' %}Visível{% else %}Oculto{% endif %}
                                                </label>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    {% else %}
                                        <div class="alert alert-info mb-0">
                                            <i class="bi bi-info-circle me-2"></i>
                                            Nenhum edital disponível.
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <div class="visibility-toggle">
                                <h6 class="mb-3"><i class="bi bi-files me-2 text-info"></i>Anexos e Documentos</h6>
                                <p class="text-muted small mb-3">Os anexos são sempre visíveis para os alunos quando há editais publicados</p>
                                
                                <div class="alert alert-success">
                                    <i class="bi bi-check-circle me-2"></i>
                                    <strong>5 anexos</strong> estão disponíveis para download
                                </div>
                                
                                <div class="d-grid gap-2">
                                    <button class="btn btn-outline-primary" data-bs-toggle="tab" data-bs-target="#anexos">
                                        <i class="bi bi-gear me-2"></i>Gerenciar Anexos
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-lightbulb me-2"></i>
                        <strong>Dica:</strong> Use o controle de visibilidade para ocultar temporariamente editais sem excluí-los. Editais ocultos não aparecem para os alunos, mas ficam salvos no sistema.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Novo Edital -->
    <div class="modal fade" id="novoEditalModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-file-earmark-plus me-2"></i>Publicar Novo Edital
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <form id="novoEditalForm" method="post" action="/assistente/editais/publicar" enctype="multipart/form-data">
                    <div class="modal-body">
                        <div id="erroModalContainer"></div>
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-type me-1"></i>Título do Edital *
                                </label>
                                <input type="text" class="form-control" name="titulo" placeholder="Ex: Edital 001/2025 - Programa de Assistência Estudantil" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-card-text me-1"></i>Descrição *
                                </label>
                                <textarea class="form-control" name="descricao" rows="3" placeholder="Descreva o objetivo e o conteúdo do edital..." required></textarea>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-event me-1"></i>Data de Publicação *
                                </label>
                                <input type="date" class="form-control" name="data_publicacao" required>
                            </div>
                            
                            <div class="col-md-4 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-check me-1"></i>Início das Inscrições *
                                </label>
                                <input type="date" class="form-control" name="data_inicio_inscricao" required>
                            </div>
                            
                            <div class="col-md-4 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-x me-1"></i>Fim das Inscrições *
                                </label>
                                <input type="date" class="form-control" name="data_fim_inscricao" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-range me-1"></i>Início da Vigência *
                                </label>
                                <input type="date" class="form-control" name="data_inicio_vigencia" required>
                                <small class="text-muted">Data inicial de pagamento dos auxílios</small>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-range me-1"></i>Fim da Vigência *
                                </label>
                                <input type="date" class="form-control" name="data_fim_vigencia" required>
                                <small class="text-muted">Data final de pagamento dos auxílios</small>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-file-pdf me-1"></i>Arquivo PDF do Edital *
                                </label>
                                <input type="file" class="form-control" name="arquivo" accept=".pdf" required>
                                <small class="text-muted">Selecione o arquivo PDF (máximo 10MB)</small>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" name="ativo" id="novoAtivo" checked>
                                    <label class="form-check-label fw-bold" for="novoAtivo">
                                        <i class="bi bi-eye me-1"></i>Publicar como visível para alunos
                                    </label>
                                    <div class="form-text">Se desmarcado, o edital ficará salvo mas não será exibido para os alunos</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-circle me-1"></i>Cancelar
                        </button>
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-check-circle me-1"></i>Publicar Edital
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Editar Edital -->
    <div class="modal fade" id="editarEditalModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title">
                        <i class="bi bi-pencil-square me-2"></i>Editar Edital
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="editarEditalForm" method="post" action="/assistente/editais/editar">
                    <div class="modal-body">
                        <input type="hidden" id="editarIdEdital" name="id_edital">
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-type me-1"></i>Título do Edital *
                                </label>
                                <input type="text" class="form-control" id="editarTitulo" name="titulo" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-card-text me-1"></i>Descrição *
                                </label>
                                <textarea class="form-control" id="editarDescricao" name="descricao" rows="3" required></textarea>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-check me-1"></i>Início das Inscrições *
                                </label>
                                <input type="date" class="form-control" id="editarDataInicioInscricao" name="data_inicio_inscricao" required>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-x me-1"></i>Fim das Inscrições *
                                </label>
                                <input type="date" class="form-control" id="editarDataFimInscricao" name="data_fim_inscricao" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-range me-1"></i>Início da Vigência *
                                </label>
                                <input type="date" class="form-control" id="editarDataInicioVigencia" name="data_inicio_vigencia" required>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-calendar-range me-1"></i>Fim da Vigência *
                                </label>
                                <input type="date" class="form-control" id="editarDataFimVigencia" name="data_fim_vigencia" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="editarStatus" name="status">
                                    <label class="form-check-label fw-bold" for="editarStatus">
                                        <i class="bi bi-eye me-1"></i>Visível para alunos
                                    </label>
                                    <div class="form-text">Desmarque para ocultar o edital dos alunos temporariamente</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-circle me-1"></i>Cancelar
                        </button>
                        <button type="submit" class="btn btn-warning">
                            <i class="bi bi-check-circle me-1"></i>Salvar Alterações
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Excluir Edital -->
    <div class="modal fade" id="excluirEditalModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-exclamation-triangle me-2"></i>Confirmar Exclusão
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Tem certeza que deseja excluir o edital:</p>
                    <p class="fw-bold text-center fs-5" id="excluirTituloEdital"></p>
                    <div class="alert alert-danger mb-0">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <strong>Atenção:</strong> Esta ação é irreversível! O edital e todas as suas informações serão permanentemente removidos.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle me-1"></i>Cancelar
                    </button>
                    <form id="excluirEditalForm" method="post" action="/assistente/editais/excluir" style="display: inline;">
                        <input type="hidden" id="excluirIdEdital" name="id_edital">
                        <button type="submit" class="btn btn-danger">
                            <i class="bi bi-trash me-1"></i>Excluir Permanentemente
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Logout -->
    <div class="modal fade" id="logoutModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-exclamation-triangle text-warning me-2"></i>Confirmar Saída
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Tem certeza que deseja sair do sistema?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <a href="/logout" class="btn btn-danger">
                        <i class="bi bi-box-arrow-right me-1"></i>Confirmar Saída
                    </a>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer bg-success text-white py-4 mt-5">
        <div class="container text-center">
            <p class="mb-0">&copy; 2025 Sistema de Controle de Assistência Estudantil. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/dashboard_assistente.js"></script>
    <script>
        // Funções do modal de edição
        function abrirModalEditar(id, titulo, descricao, dataInicio, dataFim, dataInicioVig, dataFimVig, status) {
            document.getElementById('editarIdEdital').value = id;
            document.getElementById('editarTitulo').value = titulo;
            document.getElementById('editarDescricao').value = descricao;
            document.getElementById('editarDataInicioInscricao').value = dataInicio;
            document.getElementById('editarDataFimInscricao').value = dataFim;
            document.getElementById('editarDataInicioVigencia').value = dataInicioVig;
            document.getElementById('editarDataFimVigencia').value = dataFimVig;
            document.getElementById('editarStatus').checked = (status === 'ativo');
            
            new bootstrap.Modal(document.getElementById('editarEditalModal')).show();
        }
        
        // Função do modal de exclusão
        function abrirModalExcluir(id, titulo) {
            document.getElementById('excluirIdEdital').value = id;
            document.getElementById('excluirTituloEdital').textContent = titulo;
            
            new bootstrap.Modal(document.getElementById('excluirEditalModal')).show();
        }
        
        // Função para alterar visibilidade
        function alternarVisibilidade(idEdital, novoStatus) {
            if (confirm(`Tem certeza que deseja ${novoStatus === 'ativo' ? 'tornar visível' : 'ocultar'} este edital?`)) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/assistente/editais/alterar-visibilidade';
                
                const inputId = document.createElement('input');
                inputId.type = 'hidden';
                inputId.name = 'id_edital';
                inputId.value = idEdital;
                
                const inputStatus = document.createElement('input');
                inputStatus.type = 'hidden';
                inputStatus.name = 'status';
                inputStatus.value = novoStatus;
                
                form.appendChild(inputId);
                form.appendChild(inputStatus);
                document.body.appendChild(form);
                form.submit();
            }
        }
    </script>
</body>
</html>
