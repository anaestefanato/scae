<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>{% block title %}SCAE - Base{% endblock %}</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" />
		<link rel="stylesheet" href="/static/css/styles.css" />
		<link rel="icon" type="image/png" href="/static/img/logo.png" />
		<style>
			/* Garantir z-index correto da sidebar e backdrop */
			.sidebar {
				z-index: 1050 !important;
			}
			
			.sidebar-backdrop {
				z-index: 1040 !important;
			}
			
			.menu-toggle {
				z-index: 1100 !important;
			}
			
			/* Sobrescrever regras do styles.css que escondem spans em mobile */
			.sidebar .nav-link span,
			.sidebar .btn span {
				display: inline !important;
			}
			
			.sidebar .nav-link i {
				margin-right: 10px !important;
				font-size: 1rem !important;
			}
			
			.sidebar-header h6,
			.sidebar-header small {
				display: block !important;
			}
			
			/* Garantir largura adequada da sidebar - igual ao admin */
			@media (max-width: 992px) {
				.sidebar {
					width: 250px !important;
					overflow: visible !important;
				}
			}
			
			@media (max-width: 480px) {
				.sidebar {
					width: 100% !important;
				}
			}
		</style>
		<style>
			html, body {
				height: 100%;
			}
			body {
				display: flex;
				flex-direction: column;
				min-height: 100vh;
			}
			.page-wrapper {
				flex: 1;
				display: flex;
				flex-direction: column;
			}
			.main-content {
				flex: 1;
			}
			.footer {
				margin-top: auto;
			}
		</style>
		{% block head %}{% endblock %}
	</head>
	<body>
		<div class="page-wrapper">
		<button class="menu-toggle visible" id="menuToggle">
			<i class="bi bi-list"></i>
		</button>

		<div class="sidebar collapsed" id="sidebar">
			<div class="sidebar-header">
				<button class="close-sidebar" id="closeSidebar">
					<i class="bi bi-x-lg"></i>
				</button>
				<img src="/static/img/logoifes.png" alt="Logo IFES" width="180" />
			</div>
			<div class="d-flex flex-column p-3">
				<div class="mb-4 text-center">
					<h6 class="mb-0">Sistema de Controle de</h6>
					<h6>Assistência Estudantil</h6>
				</div>
				<ul class="nav nav-pills flex-column mb-auto">
					<li class="nav-item">
						<a href="/aluno/inicio" class="nav-link {% if active_page == 'inicio' %}bg-success text-white{% endif %}">
							<i class="bi bi-house-door"></i>
							<span>Início</span>
						</a>
					</li>
					<li class="nav-item">
						<a href="/aluno/editais" class="nav-link {% if active_page == 'editais' %}bg-success text-white{% endif %}">
							<i class="bi bi-file-earmark-text"></i>
							<span>Editais</span>
						</a>
					</li>
					<li class="nav-item">
						<a href="/aluno/acompanhar-inscricoes" class="nav-link {% if active_page == 'acompanhar-inscricoes' %}bg-success text-white{% endif %}">
							<i class="bi bi-search"></i>
							<span>Acompanhar Inscrições</span>
						</a>
					</li>
					<li class="nav-item">
						<a href="/aluno/recebimentos" class="nav-link {% if active_page == 'recebimentos' %}bg-success text-white{% endif %}">
							<i class="bi bi-clipboard-check"></i>
							<span>Histórico de Recebimentos</span>
						</a>
					</li>
					<li class="nav-item">
						<a href="/aluno/duvidas" class="nav-link {% if active_page == 'duvidas' %}bg-success text-white{% endif %}">
							<i class="bi bi-question-circle"></i>
							<span>Dúvidas Frequentes</span>
						</a>
					</li>
					<li class="nav-item">
						<a href="/aluno/notificacoes" class="nav-link {% if active_page == 'notificacoes' %}bg-success text-white{% endif %}">
							<i class="bi bi-bell"></i>
							<span>Notificações</span>
						</a>
					</li>
					<li class="nav-item">
						<a href="/aluno/perfil" class="nav-link {% if active_page == 'perfil' %}bg-success text-white{% endif %}">
							<i class="bi bi-person"></i>
							<span>Meu Perfil</span>
						</a>
					</li>
					<li class="nav-item">
						<a href="/aluno/suporte" class="nav-link {% if active_page == 'suporte' %}bg-success text-white{% endif %}">
							<i class="bi bi-question-circle"></i>
							<span>Suporte</span>
						</a>
					</li>
				</ul>
				<hr />
				<div class="text-center">
					<a href="/logout" class="btn btn-outline-danger">
						<i class="bi bi-box-arrow-right"></i>
						<span>Sair</span>
					</a>
				</div>
			</div>
		</div>

		<div class="content-wrapper" style="flex: 1;">
			{% block content %}{% endblock %}
		</div>

		<footer class="footer bg-success text-white py-4">
			<div class="container">
				<div class="row">
					<div class="col-12 text-center">
						<p class="text-white mb-0">
							&copy; 2025 Sistema de Controle de Assistência Estudantil. Todos os direitos reservados.
						</p>
					</div>
				</div>
			</div>
		</footer>
		</div> <!-- Fechamento do page-wrapper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
        <script>
			document.addEventListener("DOMContentLoaded", function () {
				const sidebar = document.getElementById("sidebar");
				const mainContent = document.getElementById("mainContent");
				const menuToggle = document.getElementById("menuToggle");
				const closeSidebar = document.getElementById("closeSidebar");
				const body = document.body;
				
				// Criar backdrop se não existir
				let sidebarBackdrop = document.querySelector('.sidebar-backdrop');
				if (!sidebarBackdrop) {
					sidebarBackdrop = document.createElement('div');
					sidebarBackdrop.className = 'sidebar-backdrop';
					body.appendChild(sidebarBackdrop);
				}
				
				// Remover backdrops duplicados
				const allBackdrops = document.querySelectorAll('.sidebar-backdrop');
				allBackdrops.forEach(function (backdrop) {
					if (sidebarBackdrop && backdrop !== sidebarBackdrop) {
						backdrop.remove();
					}
				});

				// Funções de controle da sidebar
				function openSidebar() {
					if (sidebar) {
						sidebar.classList.remove('collapsed');
						sidebar.classList.add('open');
					}
					if (mainContent) {
						mainContent.classList.add('shifted');
					}
					if (menuToggle) {
						menuToggle.classList.remove('visible');
						menuToggle.classList.add('hidden');
					}
					if (sidebarBackdrop) {
						sidebarBackdrop.classList.add('visible');
					}
					body.style.overflow = 'hidden';
				}

				function closeSidebarFunc() {
					if (sidebar) {
						sidebar.classList.remove('open');
						sidebar.classList.add('collapsed');
					}
					if (mainContent) {
						mainContent.classList.remove('shifted');
					}
					if (menuToggle) {
						menuToggle.classList.add('visible');
						menuToggle.classList.remove('hidden');
					}
					if (sidebarBackdrop) {
						sidebarBackdrop.classList.remove('visible');
					}
					body.style.overflow = '';
				}

				// Event listeners
				if (menuToggle) {
					menuToggle.addEventListener('click', openSidebar);
				}

				if (closeSidebar) {
					closeSidebar.addEventListener('click', closeSidebarFunc);
				}

				if (sidebarBackdrop) {
					sidebarBackdrop.addEventListener('click', closeSidebarFunc);
				}

				// Fechar sidebar com ESC
				document.addEventListener('keydown', function (event) {
					if (event.key === 'Escape' && sidebar && sidebar.classList.contains('open')) {
						closeSidebarFunc();
					}
				});
			});
        </script>
		{% block scripts %}
		{% endblock %}
    </body>
</html>
